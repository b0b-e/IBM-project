Emotion Analysis — Flask web app
================================

**Overview**
- This project is a small Flask web app that loads pre-trained sklearn artifacts (model, TF-IDF vectorizer, and label encoder) from the sibling `Model/` folder, accepts a text input, predicts the emotion, and displays the prediction with an emoji and a confidence percentage (when available).

**Project Structure**
- `App/` : application source and helpers
  - `app.py` : Flask app — loads model artifacts, exposes `/` and `/predict`, computes confidence (uses `predict_proba()` when available). Runs with `app.run(debug=True)` for local testing.
  - `emotionAnalysis.py` : compatibility wrapper (for legacy calls). It attempts to run the relocated training script in `App/Training Files/`.
  - `Training Files/training_model.py` : primary training/retrain script (TF-IDF + LogisticRegression) that saves artifacts to `Model/`.
  - `Training Files/training_notebook.ipynb` : Jupyter notebook with exploratory steps and examples (optional, not required to run the app).
  - `templates/index.html` : Jinja2 template (modern cyan+white UI). Uses AJAX to submit text, Enter to submit, Shift+Enter for newline, animates emoji, and displays confidence.
  - `templates/index.html` : Jinja2 template (modern cyan+white UI). Uses AJAX to submit text, Enter to submit, Shift+Enter for newline, animates emoji, and displays confidence.
  - `requirements.txt` : Python dependencies for the app (install with pip).
- `Model/` : stored model artifacts (these are not generated by the app)
  - `emotion_model.pkl` : trained sklearn model (e.g., Naive Bayes / LogisticRegression)
  - `tfidf_vectorizer.pkl` : TF-IDF vectorizer persisted from training
  - `label_encoder.pkl` : Label encoder for mapping numeric labels to emotion names

- `Dataset/` : text datasets used for training / verification
  - `train.txt`, `val.txt`, `test.txt`

- Project root
  - `README.md` (this file)
  - (optionally) `.venv/` : virtual environment (not committed)

**How to run (Windows / PowerShell)**
1. Create and activate a virtual environment (from project root):

```powershell
python -m venv .venv
& ".\.venv\Scripts\Activate.ps1"
```

2. Install dependencies and start the app:

```powershell
pip install -r requirements.txt
python App/app.py
```

3. Open the app in a browser at `http://127.0.0.1:5000`.

Running the training script (optional)
- The main training script is `App/Training Files/training_model.py` (there's also a notebook `training_notebook.ipynb` for exploration).
- To retrain and regenerate artifacts, run:

```powershell
python "App/Training Files/training_model.py"
```
or (for compatibility) you can still run the wrapper at:

```powershell
python App/emotionAnalysis.py
```

**Notes & Behavior**
- Model loading: the app prefers `joblib.load()` for sklearn artifacts and falls back to `pickle.load()` when needed. If the artifacts were created with a different scikit-learn version, you may see an `InconsistentVersionWarning` — this is a warning only; predictions should still work in most cases. If loading fails, run `python App/test_load_model.py` to inspect the files.
- Endpoints:
  - `GET /` — main page (renders `index.html`)
  - `POST /predict` — main form posts here; `app.py` returns the template including `prediction`, `emoji`, and `text` template variables.
- Template variables preserved by backend: `{{ prediction }}`, `{{ emoji }}`, `{{ text }}`, and `{{ error }}`.
- Frontend UX: Enter submits the form, Shift+Enter inserts a newline; submission is sent by AJAX and the results block updates in-place to avoid browser "resubmit form" prompts. The UI shows an emoji and a confidence percent (rounded to 2 decimals) when `predict_proba()` is available.

**Troubleshooting**
 - If models don't load or throw unpickling errors:
  - Ensure the three required files are in `Model/` with the expected names (`emotion_model.pkl`, `tfidf_vectorizer.pkl`, `label_encoder.pkl`).
  - Check that the files are readable and were not corrupted during transfer.
  - Consider matching your local `scikit-learn` version to the version used when the model was saved (the warning printed at load time includes that information).
  - For diagnostics, run the training script to regenerate artifacts: `python "App/Training Files/training_model.py"` or inspect the `Model/` files manually.

**Extending / Next steps**
- Pin `scikit-learn` to the model save version to silence warnings and ensure reproducibility.
- Move inline CSS from `templates/index.html` to `App/static/style.css` if you prefer separate static assets.
- Add a JSON API endpoint (e.g., `/api/predict`) if you need programmatic access.

**Contact / Credits**
- If you need help running the app or want changes (static extraction, API endpoint, Dockerfile), open an issue or ask for help.
